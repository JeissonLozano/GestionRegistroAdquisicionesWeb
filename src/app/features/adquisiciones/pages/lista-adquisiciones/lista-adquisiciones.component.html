<!-- Header compartido -->
<app-header></app-header>

<!-- Contenedor principal -->
<div class="main-container">
  <!-- Encabezado de p√°gina -->
  <div class="page-header">
    <h1 class="page-title">Gestionar Adquisiciones</h1>
    <p class="page-subtitle">Control total de requerimientos, presupuestos y proveedores en tiempo real</p>
  </div>

  <!-- Bot√≥n de Volver -->
  <div class="back-section">
    <button class="back-btn" (click)="volver()">
      ‚Üê Volver al Inicio
    </button>
  </div>

  <!-- Secci√≥n de controles -->
  <div class="controls-section">
    <div class="controls-grid">
      <div class="search-container">
        <span class="search-icon">üîç</span>
        <input 
          type="text" 
          class="search-input" 
          placeholder="Buscar por proveedor, tipo de bien o documentaci√≥n..."
          [(ngModel)]="terminoBusqueda"
          (input)="buscarAdquisiciones()"
        >
      </div>
      <button class="create-btn" (click)="crearAdquisicion()">
        ‚ûï Crear Adquisici√≥n
      </button>
    </div>
  </div>

  <!-- Contenedor de tabla -->
  <div class="table-container">
    <div class="table-header">
      <div class="table-title">Lista de Adquisiciones</div>
      <div class="table-count">Mostrando {{ (paginaActual - 1) * elementosPorPagina + 1 }}-{{ Math.min(paginaActual * elementosPorPagina, adquisicionesFiltradas.length) }} de {{ adquisicionesFiltradas.length }} registros</div>
    </div>

    <table class="data-table">
      <thead>
        <tr>
          <th class="row-number">No.</th>
          <th>Presupuesto</th>
          <th>Unidad</th>
          <th>Tipo de Bien/Servicio</th>
          <th>Cantidad</th>
          <th>Valor Unitario</th>
          <th>Valor Total</th>
          <th>Fecha Adquisici√≥n</th>
          <th>Proveedor</th>
          <th>Documentaci√≥n</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let adquisicion of adquisicionesPaginadas; let i = index">
          <td class="row-number">{{ (paginaActual - 1) * elementosPorPagina + i + 1 }}</td>
          <td class="budget-cell">{{ adquisicion.presupuesto | currency:'$':'symbol':'1.0-0' }}</td>
          <td class="unit-cell">{{ adquisicion.unidadAdministrativa }}</td>
          <td class="type-cell">{{ adquisicion.tipoBienServicio }}</td>
          <td>{{ adquisicion.cantidad | number }} unidades</td>
          <td>{{ adquisicion.valorUnitario | currency:'$':'symbol':'1.0-0' }}</td>
          <td class="budget-cell">{{ adquisicion.valorTotal | currency:'$':'symbol':'1.0-0' }}</td>
          <td class="date-cell">{{ adquisicion.fechaAdquisicion | date:'longDate' }}</td>
          <td class="provider-cell">{{ adquisicion.proveedor }}</td>
          <td>{{ adquisicion.documentacion }}</td>
          <td class="actions-cell">
            <div class="action-buttons">
              <button 
                class="action-btn edit-btn" 
                (click)="editarAdquisicion(adquisicion.id)" 
                title="Editar"
              >
                ‚úèÔ∏è
              </button>
              <button 
                class="action-btn view-btn" 
                (click)="verHistorial(adquisicion.id)"
                title="Ver Historial"
              >
                üëÅÔ∏è
              </button>
              <button 
                class="action-btn toggle-btn" 
                [class.active]="adquisicion.activo"
                (click)="toggleEstadoAdquisicion(adquisicion.id, adquisicion.activo)"
                [disabled]="cambiandoEstado"
                [title]="adquisicion.activo ? 'Desactivar' : 'Activar'"
              >
                {{ adquisicion.activo ? 'üü¢' : 'üî¥' }}
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- Paginaci√≥n -->
    <div class="pagination-container">
      <div class="pagination">
        <button 
          class="page-btn" 
          (click)="cambiarPagina(paginaActual - 1)"
          [disabled]="paginaActual === 1"
        >
          ‚Üê
        </button>
        <button 
          *ngFor="let pagina of paginas" 
          class="page-btn" 
          [class.active]="pagina === paginaActual"
          (click)="cambiarPagina(pagina)"
        >
          {{ pagina }}
        </button>
        <button 
          class="page-btn" 
          (click)="cambiarPagina(paginaActual + 1)"
          [disabled]="paginaActual === totalPaginas"
        >
          ‚Üí
        </button>
      </div>
    </div>
  </div>
</div>
